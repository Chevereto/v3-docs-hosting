(window.webpackJsonp=window.webpackJsonp||[]).push([[58],{446:function(t,e,a){"use strict";a.r(e);var s=a(49),r=Object(s.a)({},(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"server-requirements"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#server-requirements"}},[t._v("#")]),t._v(" Server Requirements")]),t._v(" "),a("h2",{attrs:{id:"php"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#php"}},[t._v("#")]),t._v(" PHP")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("Version")]),t._v(" "),a("th",[t._v("PHP")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("3.20")]),t._v(" "),a("td",[t._v("7.4")])])])]),t._v(" "),a("p",[t._v("Chevereto is "),a("a",{attrs:{href:"https://php.net/",target:"_blank",rel:"noopener noreferrer"}},[t._v("PHP"),a("OutboundLink")],1),t._v(" software, it has been designed using:")]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://deb.sury.org/",target:"_blank",rel:"noopener noreferrer"}},[t._v("PHP packages"),a("OutboundLink")],1),t._v(" from Ondřej Surý.")]),t._v(" "),a("li",[a("a",{attrs:{href:"https://www.php.net/manual/en/extensions.membership.php",target:"_blank",rel:"noopener noreferrer"}},[t._v("PHP extensions"),a("OutboundLink")],1),t._v(" provided by "),a("a",{attrs:{href:"https://pecl.php.net/",target:"_blank",rel:"noopener noreferrer"}},[t._v("PECL"),a("OutboundLink")],1),t._v(".")])]),t._v(" "),a("p",[t._v("Packages and PECL provides the same convenience, but as packages are made for debian-based systems you should prefer PECL if you don't have a compatible system.")]),t._v(" "),a("div",{staticClass:"custom-block warning"},[a("p",{staticClass:"custom-block-title"},[t._v("Packages vs PECL")]),t._v(" "),a("p",[t._v("Note that packages not only contain the software, it could also trigger other effects in the system.")])]),t._v(" "),a("h3",{attrs:{id:"php-configuration"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#php-configuration"}},[t._v("#")]),t._v(" PHP configuration")]),t._v(" "),a("p",[t._v("The following "),a("code",[t._v("ini")]),t._v(" values are recommended for Chevereto installations.")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[t._v("upload_max_filesize "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" 50M"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\npost_max_size "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" 50M"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nmax_execution_time "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("30")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nmemory_limit "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" 512M"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("table",[a("thead",[a("tr",[a("th",[t._v("Property")]),t._v(" "),a("th",[t._v("Description")]),t._v(" "),a("th",[t._v("Example")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("upload_max_filesize")]),t._v(" "),a("td",[t._v("Maximum upload size")]),t._v(" "),a("td",[a("code",[t._v("50M")]),t._v(" for 50 MB")])]),t._v(" "),a("tr",[a("td",[t._v("post_max_size")]),t._v(" "),a("td",[t._v("Maximum post size")]),t._v(" "),a("td",[t._v("Same as above")])]),t._v(" "),a("tr",[a("td",[t._v("max_execution_time")]),t._v(" "),a("td",[t._v("Maximum time to execute the software, in seconds")]),t._v(" "),a("td",[a("code",[t._v("30")]),t._v(" for 30 seconds")])]),t._v(" "),a("tr",[a("td",[t._v("memory_limit")]),t._v(" "),a("td",[t._v("Maximum memory to allocate")]),t._v(" "),a("td",[a("code",[t._v("512M")]),t._v(" for 512 MB")])])])]),t._v(" "),a("p",[t._v("You can toggle this limits to reflect your hardware and server load. Check this article for more info: "),a("a",{attrs:{href:"http://www.php.net/manual/en/features.file-upload.common-pitfalls.php",target:"_blank",rel:"noopener noreferrer"}},[t._v("PHP common pitfalls"),a("OutboundLink")],1),t._v(".")]),t._v(" "),a("h3",{attrs:{id:"php-extensions"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#php-extensions"}},[t._v("#")]),t._v(" PHP Extensions")]),t._v(" "),a("p",[t._v("The following PHP extensions are required for Chevereto.")]),t._v(" "),a("ul",[a("li",[t._v("curl")]),t._v(" "),a("li",[t._v("exif")]),t._v(" "),a("li",[t._v("fileinfo")]),t._v(" "),a("li",[t._v("hash")]),t._v(" "),a("li",[t._v("imagick")]),t._v(" "),a("li",[t._v("gd")]),t._v(" "),a("li",[t._v("json")]),t._v(" "),a("li",[t._v("mbstring")]),t._v(" "),a("li",[t._v("pdo")]),t._v(" "),a("li",[t._v("pdo-mysql")]),t._v(" "),a("li",[t._v("session")]),t._v(" "),a("li",[t._v("xml")]),t._v(" "),a("li",[t._v("zip")])]),t._v(" "),a("h3",{attrs:{id:"php-features"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#php-features"}},[t._v("#")]),t._v(" PHP Features")]),t._v(" "),a("p",[t._v("Chevereto requires unrestricted access to all PHP functions. If some or any PHP function is removed it could cause Chevereto to fail or to not work at all. Note that the following functions must not be restricted:")]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://www.php.net/set-time-limit",target:"_blank",rel:"noopener noreferrer"}},[t._v("set_time_limit"),a("OutboundLink")],1)])]),t._v(" "),a("h2",{attrs:{id:"image-library"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#image-library"}},[t._v("#")]),t._v(" Image library")]),t._v(" "),a("p",[t._v("The image library (GD, Imagick) should be provided with support for "),a("code",[t._v("PNG GIF JPG BMP WEBP")]),t._v(". By default, Chevereto uses Imagick and fallback to GD.")]),t._v(" "),a("p",[t._v("If you need to explicit use GD you can add this key to "),a("RouterLink",{attrs:{to:"/setup/server/settings-file.html"}},[t._v("Settings file")]),t._v(":")],1),t._v(" "),a("div",{staticClass:"language-php extra-class"},[a("pre",{pre:!0,attrs:{class:"language-php"}},[a("code",[a("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("'image_library'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("'gd'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n")])])]),a("div",{staticClass:"custom-block danger"},[a("p",{staticClass:"custom-block-title"},[t._v("Workaround missing formats")]),t._v(" "),a("p",[t._v("If the server setup can't provide all the image formats you must use the following "),a("RouterLink",{attrs:{to:"/setup/server/settings-file.html"}},[t._v("Settings file")]),t._v(" workaround. In the following example Chevereto is configured with explicit support only for "),a("code",[t._v("PNG, GIF")]),t._v(":")],1),t._v(" "),a("div",{staticClass:"language-php extra-class"},[a("pre",{pre:!0,attrs:{class:"language-php"}},[a("code",[a("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("'image_formats_available'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("'PNG'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("'GIF'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n")])])])]),t._v(" "),a("h2",{attrs:{id:"configuring-image-library"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#configuring-image-library"}},[t._v("#")]),t._v(" Configuring image library")]),t._v(" "),a("p",[t._v("Check for "),a("RouterLink",{attrs:{to:"/setup/server/environment.html#image-handling-variables"}},[t._v("CHEVERETO_IMAGE_LIBRARY")]),t._v(" for changing the default image library used by Chevereto.")],1),t._v(" "),a("h3",{attrs:{id:"imagemagick"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#imagemagick"}},[t._v("#")]),t._v(" ImageMagick")]),t._v(" "),a("p",[t._v("Additional recommended ImageMagick configuration at "),a("code",[t._v("/etc/ImageMagick-6/policy.xml")]),t._v(" file:")]),t._v(" "),a("div",{staticClass:"language-xml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-xml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("policymap")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\x3c!-- policies --\x3e")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("policy")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("domain")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("resource"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("name")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("width"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("value")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("16KP"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("policy")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("domain")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("resource"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("name")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("height"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("value")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("16KP"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("policymap")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),a("h3",{attrs:{id:"filesystem"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#filesystem"}},[t._v("#")]),t._v(" Filesystem")]),t._v(" "),a("p",[t._v("User running "),a("code",[t._v("php")]),t._v(" must be in the owner group of your installation directory. This is required to allow Chevereto to modify the filesystem for uploading, one-click update and many other features.")]),t._v(" "),a("blockquote",[a("p",[t._v("PHP usually runs under "),a("code",[t._v("www-data")])])]),t._v(" "),a("p",[t._v("Chevereto user will require "),a("strong",[t._v("read/write")]),t._v(" access in the following paths:")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("/tmp")])]),t._v(" "),a("li",[a("code",[t._v("app/content/")])]),t._v(" "),a("li",[a("code",[t._v("app/content/languages/")])]),t._v(" "),a("li",[a("code",[t._v("app/content/languages/cache/")])]),t._v(" "),a("li",[a("code",[t._v("app/content/system/")])]),t._v(" "),a("li",[a("code",[t._v("content/")])]),t._v(" "),a("li",[a("code",[t._v("images/")])])]),t._v(" "),a("h2",{attrs:{id:"database"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#database"}},[t._v("#")]),t._v(" Database")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("Version")]),t._v(" "),a("th",[t._v("MySQL")]),t._v(" "),a("th",[t._v("MariaDB")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("3.20")]),t._v(" "),a("td",[t._v("5.7, 8")]),t._v(" "),a("td",[t._v("10")])])])]),t._v(" "),a("ul",[a("li",[t._v("Database user must have "),a("code",[t._v("ALL PRIVILEGES")]),t._v(" over the target database")]),t._v(" "),a("li",[t._v("InnoDB table storage engine")])]),t._v(" "),a("div",{staticClass:"custom-block danger"},[a("p",{staticClass:"custom-block-title"},[t._v("Upgrading from old installation")]),t._v(" "),a("p",[t._v("Old versions using MyISAM table storage engine will require to manually convert the alleged tables to InnoDB. Read "),a("a",{attrs:{href:"https://dev.mysql.com/doc/refman/8.0/en/converting-tables-to-innodb.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("Convert MyISAM tables to InnoDB"),a("OutboundLink")],1)])]),t._v(" "),a("h2",{attrs:{id:"web-server"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#web-server"}},[t._v("#")]),t._v(" Web server")]),t._v(" "),a("h3",{attrs:{id:"url-rewriting"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#url-rewriting"}},[t._v("#")]),t._v(" URL rewriting")]),t._v(" "),a("p",[t._v("The web server must rewrite HTTP requests like "),a("code",[t._v("GET /image/some-name.<id>")]),t._v(" to "),a("code",[t._v("/index.php")]),t._v(". Instructions for "),a("a",{attrs:{href:"https://nginx.org/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Nginx"),a("OutboundLink")],1),t._v(" and "),a("a",{attrs:{href:"https://httpd.apache.org/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Apache HTTP Server"),a("OutboundLink")],1),t._v(" below.")]),t._v(" "),a("h4",{attrs:{id:"nginx-url-rewriting"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#nginx-url-rewriting"}},[t._v("#")]),t._v(" Nginx URL rewriting")]),t._v(" "),a("p",[a("code",[t._v("example.com.conf")])]),t._v(" "),a("div",{staticClass:"language-nginx extra-class"},[a("pre",{pre:!0,attrs:{class:"language-nginx"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Context limits")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("client_max_body_size")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("50")]),t._v("M"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Disable access to sensitive files")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("location")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("~")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("app"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("content"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("lib"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("\\"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("po"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("php"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("lock"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("sql"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("$ "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("deny")]),t._v(" all"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Image not found replacement")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("location")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("~")]),t._v(" \\"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("jpe"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),t._v("g"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("png"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("gif"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("webp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("$ "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("log_not_found")]),t._v(" off"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("error_page")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("404")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("content"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("images"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("system"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("default"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("404.")]),t._v("gif"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# CORS header (avoids font rendering issues)")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("location")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("~")]),t._v(" \\"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ttf"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("ttc"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("otf"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("eot"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("woff"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("woff2"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("font"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("css"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("css"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("js"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("$ "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("add_header")]),t._v(" Access"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Control"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Allow")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Origin "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"*"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Pretty URLs")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("location")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("index")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("index")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("php"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("try_files")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$uri")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$uri")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("index")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("php"),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$is_args")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$query_string")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h4",{attrs:{id:"apache-http-server-url-rewriting"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#apache-http-server-url-rewriting"}},[t._v("#")]),t._v(" Apache HTTP Server URL rewriting")]),t._v(" "),a("p",[t._v("Make sure that "),a("a",{attrs:{href:"https://httpd.apache.org/docs/current/mod/mod_rewrite.html",target:"_blank",rel:"noopener noreferrer"}},[a("code",[t._v("mod_rewrite")]),a("OutboundLink")],1),t._v(" is enabled and that your virtual host settings allows to perform URL rewriting:")]),t._v(" "),a("div",{staticClass:"language-apacheconf extra-class"},[a("pre",{pre:!0,attrs:{class:"language-apacheconf"}},[a("code",[t._v("    "),a("span",{pre:!0,attrs:{class:"token directive-block tag"}},[a("span",{pre:!0,attrs:{class:"token directive-block tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("Directory")]),a("span",{pre:!0,attrs:{class:"token directive-block-parameter attr-value"}},[t._v(" /var/www/html")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token directive-inline property"}},[t._v("Options")]),t._v(" -Indexes +FollowSymLinks +MultiViews\n        "),a("span",{pre:!0,attrs:{class:"token directive-inline property"}},[t._v("AllowOverride")]),t._v(" All\n        "),a("span",{pre:!0,attrs:{class:"token directive-inline property"}},[t._v("Require")]),t._v(" all granted\n    "),a("span",{pre:!0,attrs:{class:"token directive-block tag"}},[a("span",{pre:!0,attrs:{class:"token directive-block tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("Directory")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),a("p",[t._v("Apache configuration "),a("code",[t._v(".htaccess")]),t._v(" files are already included in the software.")]),t._v(" "),a("p",[a("code",[t._v("/.htaccess")])]),t._v(" "),a("div",{staticClass:"language-apacheconf extra-class"},[a("pre",{pre:!0,attrs:{class:"language-apacheconf"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Disable server signature")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token directive-inline property"}},[t._v("ServerSignature")]),t._v(" Off\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Enable CORS across all your subdomains (replace dev\\.local with your domain\\.com)")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# SetEnvIf Origin ^(https?://.+\\.dev\\.local(?::\\d{1,5})?)$   CORS_ALLOW_ORIGIN=$1")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Header append Access-Control-Allow-Origin  %{CORS_ALLOW_ORIGIN}e   env=CORS_ALLOW_ORIGIN")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# Header merge  Vary "Origin"')]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Disable directory listing (-indexes), Multiviews (-MultiViews)")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token directive-inline property"}},[t._v("Options")]),t._v(" -Indexes\n"),a("span",{pre:!0,attrs:{class:"token directive-inline property"}},[t._v("Options")]),t._v(" -MultiViews\n\n"),a("span",{pre:!0,attrs:{class:"token directive-block tag"}},[a("span",{pre:!0,attrs:{class:"token directive-block tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("IfModule")]),a("span",{pre:!0,attrs:{class:"token directive-block-parameter attr-value"}},[t._v(" mod_rewrite.c")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token directive-inline property"}},[t._v("RewriteEngine")]),t._v(" On\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# If you have problems with the rewrite rules remove the "#" from the following RewriteBase line')]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# You will also have to change the path to reflect the path to your Chevereto installation")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# If you are using alias is most likely that you will need this.")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#RewriteBase /")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 404 images")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# If you want to have your own fancy "image not found" image remove the "#" from RewriteCond and RewriteRule lines')]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Make sure to apply the correct paths to reflect your current installation")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token directive-inline property"}},[t._v("RewriteCond")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("%{REQUEST_FILENAME}")]),t._v(" !-f\n    "),a("span",{pre:!0,attrs:{class:"token directive-inline property"}},[t._v("RewriteRule")]),t._v(" images/.+\\.(gif|jpe?g|png|bmp|webp) - "),a("span",{pre:!0,attrs:{class:"token directive-flags keyword"}},[t._v("[NC,L,R=404]")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#RewriteRule images/.+\\.(gif|jpe?g|a?png|bmp|webp) content/images/system/default/404.gif [NC,L]")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token directive-inline property"}},[t._v("RewriteCond")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("%{REQUEST_FILENAME}")]),t._v(" !-f\n    "),a("span",{pre:!0,attrs:{class:"token directive-inline property"}},[t._v("RewriteCond")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("%{REQUEST_FILENAME}")]),t._v(" !-d\n    "),a("span",{pre:!0,attrs:{class:"token directive-inline property"}},[t._v("RewriteCond")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("%{REQUEST_URI}")]),a("span",{pre:!0,attrs:{class:"token regex"}},[t._v(" !\\.(css|js|html|htm|rtf|rtx|svg|svgz|txt|xsd|xsl|xml|asf|asx|wax|wmv|wmx|avi|bmp|class|divx|doc|docx|exe|gif|gz|gzip|ico|jpe?g|jpe|mdb|mid|midi|mov|qt|mp3|m4a|mp4|m4v|mpeg|mpg|mpe|mpp|odb|odc|odf|odg|odp|ods|odt|ogg|pdf|png|pot|pps|ppt|pptx|ra|ram|swf|tar|tif|tiff|wav|webp|wma|wri|xla|xls|xlsx|xlt|xlw|zip)$")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token directive-flags keyword"}},[t._v("[NC]")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token directive-inline property"}},[t._v("RewriteRule")]),t._v(" . index.php "),a("span",{pre:!0,attrs:{class:"token directive-flags keyword"}},[t._v("[L]")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token directive-block tag"}},[a("span",{pre:!0,attrs:{class:"token directive-block tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("IfModule")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),a("h3",{attrs:{id:"real-connecting-ip"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#real-connecting-ip"}},[t._v("#")]),t._v(" Real connecting IP")]),t._v(" "),a("p",[t._v("For setups under any kind of proxy (including "),a("a",{attrs:{href:"https://support.cloudflare.com/hc/en-us/articles/200170786-Restoring-original-visitor-IPs",target:"_blank",rel:"noopener noreferrer"}},[t._v("CloudFlare"),a("OutboundLink")],1),t._v(") is required that the web server sets the appropriate value for the client connecting IP.")]),t._v(" "),a("div",{staticClass:"custom-block danger"},[a("p",{staticClass:"custom-block-title"},[t._v("WARNING")]),t._v(" "),a("p",[t._v("If real connecting IP is not properly configured Chevereto won't be able to detect the visitors IPs, failing to deliver IP based restrictions and flood control.")])]),t._v(" "),a("ul",[a("li",[t._v("Nginx: "),a("code",[t._v("ngx_http_realip_module")])]),t._v(" "),a("li",[t._v("Apache: "),a("code",[t._v("mod_remoteip")])])])])}),[],!1,null,null,null);e.default=r.exports}}]);