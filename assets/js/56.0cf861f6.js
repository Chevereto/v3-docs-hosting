(window.webpackJsonp=window.webpackJsonp||[]).push([[56],{448:function(t,s,a){"use strict";a.r(s);var e=a(49),n=Object(e.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"container-running"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#container-running"}},[t._v("#")]),t._v(" Container Running")]),t._v(" "),a("h2",{attrs:{id:"guides"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#guides"}},[t._v("#")]),t._v(" Guides")]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://github.com/chevereto/container-builder/blob/main/guides/portainer/README.md",target:"_blank",rel:"noopener noreferrer"}},[t._v("Portainer"),a("OutboundLink")],1)])]),t._v(" "),a("h2",{attrs:{id:"persistent-layers"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#persistent-layers"}},[t._v("#")]),t._v(" Persistent layers")]),t._v(" "),a("h3",{attrs:{id:"asset-storage"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#asset-storage"}},[t._v("#")]),t._v(" Asset storage")]),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("Local asset storage")]),t._v(" "),a("p",[t._v("To use Local Storage is required to mount the appropriate volume in a path visible to the application.")])]),t._v(" "),a("p",[t._v("For asset storage you can use any supported "),a("RouterLink",{attrs:{to:"/features/integrations/external-storage.html"}},[t._v("external storage")]),t._v(" API. This need to be configured passing "),a("RouterLink",{attrs:{to:"/setup/system/environment.html#assets-variables"}},[t._v("Assets environment variables")]),t._v(".")],1),t._v(" "),a("h3",{attrs:{id:"sessions"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#sessions"}},[t._v("#")]),t._v(" Sessions")]),t._v(" "),a("p",[t._v("For persistent sessions you can use Redis by configuring the "),a("RouterLink",{attrs:{to:"/setup/system/environment.html#session-variables"}},[t._v("Session environment variables")]),t._v(" variables.")],1),t._v(" "),a("h3",{attrs:{id:"database"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#database"}},[t._v("#")]),t._v(" Database")]),t._v(" "),a("p",[t._v("For database you can create a volume for persistence, or use a server over the network. If you manually provide the database you will need to create its user binding:")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[t._v("docker "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("exec")]),t._v(" chv-mariadb mysql -uroot -ppassword -e "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("\"CREATE DATABASE chevereto; \\\n    CREATE USER 'chevereto' IDENTIFIED BY 'user_database_password'; \\\n    GRANT ALL ON chevereto.* TO 'chevereto' IDENTIFIED BY 'user_database_password';\"")]),t._v("\n")])])]),a("h3",{attrs:{id:"user-uploads-storage"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#user-uploads-storage"}},[t._v("#")]),t._v(" User uploads storage")]),t._v(" "),a("p",[t._v("This persistent layer can be configured directly in the application "),a("RouterLink",{attrs:{to:"/settings/external-storage.html"}},[t._v("Dashboard panel")]),t._v(". You can add multiple storages, all that configuration will be stored in the database.")],1),t._v(" "),a("h2",{attrs:{id:"compose"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#compose"}},[t._v("#")]),t._v(" Compose")]),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),a("p",[t._v("Check "),a("RouterLink",{attrs:{to:"/setup/system/environment.html"}},[t._v("Environment")]),t._v(" for all the "),a("code",[t._v("-e")]),t._v(" options you can pass in the Docker command.")],1)]),t._v(" "),a("p",[t._v("In the following example volumes are used for all data persistence. The image used is "),a("a",{attrs:{href:"https://github.com/chevereto/container-builder/blob/main/httpd-php.Dockerfile",target:"_blank",rel:"noopener noreferrer"}},[t._v("httpd-php"),a("OutboundLink")],1),t._v(" which includes Apache HTTP Web server.")]),t._v(" "),a("div",{staticClass:"language-yaml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("version")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"3"')]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("services")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("chv-database")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("image")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" mariadb"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("focal\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("networks")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" chv"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("network\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("healthcheck")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("test")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"CMD-SHELL"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"mysqladmin ping --silent"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("volumes")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" chv"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("/var/lib/mysql\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("restart")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" always\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("environment")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("MYSQL_ROOT_PASSWORD")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" password\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("MYSQL_DATABASE")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" chevereto\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("MYSQL_USER")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" chevereto\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("MYSQL_PASSWORD")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" user_database_password\n\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("chv-build")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("image")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" owner/image"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("httpd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("php\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("networks")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" chv"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("network\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("volumes")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" chv"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("storage"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("/var/www/html/images/\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" chv"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("assets"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("/var/www/html/_assets/\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("ports")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" 8080"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("restart")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" always\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("environment")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("CHEVERETO_DB_HOST")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" chv"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("database\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("CHEVERETO_DB_USER")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" chevereto\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("CHEVERETO_DB_PASS")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" user_database_password\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("CHEVERETO_DB_PORT")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3306")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("CHEVERETO_DB_NAME")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" chevereto\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("CHEVERETO_HTTPS")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("CHEVERETO_ASSET_STORAGE_TYPE")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" local\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("CHEVERETO_ASSET_STORAGE_URL")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" http"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("//localhost"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("8080/_assets/\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("CHEVERETO_ASSET_STORAGE_BUCKET")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" /var/www/html/_assets/\n\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("volumes")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("chv-data")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("chv-assets")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("chv-storage")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("networks")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("chv-network")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n")])])]),a("p",[a("strong",[t._v("Note")]),t._v(" that "),a("code",[t._v("CHEVERETO_ASSET_STORAGE")]),t._v(" is mapped to the mounted volume "),a("code",[t._v("chv-assets")]),t._v(" and to the same URL. This can be mapped to any supported "),a("RouterLink",{attrs:{to:"/features/integrations/external-storage.html"}},[t._v("external storage")]),t._v(" API:")],1),t._v(" "),a("div",{staticClass:"language-yaml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[t._v("  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("chv-build")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("image")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" owner/image"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("httpd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("php\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("networks")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" chv"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("network\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("ports")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" 8080"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("restart")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" always\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("environment")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("CHEVERETO_DB_HOST")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" chv"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("database\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("CHEVERETO_DB_USER")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" chevereto\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("CHEVERETO_DB_PASS")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" user_database_password\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("CHEVERETO_DB_PORT")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3306")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("CHEVERETO_DB_NAME")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" chevereto\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("CHEVERETO_HTTPS")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("CHEVERETO_ASSET_STORAGE_NAME")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" assets\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("CHEVERETO_ASSET_STORAGE_TYPE")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" s3\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("CHEVERETO_ASSET_STORAGE_KEY")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("  key\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("CHEVERETO_ASSET_STORAGE_SECRET")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" secret\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("CHEVERETO_ASSET_STORAGE_BUCKET")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" bucket"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("name\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("CHEVERETO_ASSET_STORAGE_URL")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" https"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("//s3"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("us"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("west"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("1.amazonaws.com/bucket"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("name/\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("CHEVERETO_ASSET_STORAGE_REGION")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" s3"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("us"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("west"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n")])])]),a("h2",{attrs:{id:"first-run"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#first-run"}},[t._v("#")]),t._v(" First run")]),t._v(" "),a("p",[t._v("Refer to "),a("RouterLink",{attrs:{to:"/manual/first-steps/"}},[t._v("First-steps")]),t._v(" instructions.")],1)])}),[],!1,null,null,null);s.default=n.exports}}]);