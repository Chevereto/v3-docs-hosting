(window.webpackJsonp=window.webpackJsonp||[]).push([[53],{375:function(t,e,a){"use strict";a.r(e);var s=a(46),r=Object(s.a)({},(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"requirements"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#requirements"}},[t._v("#")]),t._v(" Requirements")]),t._v(" "),a("ul",[a("li",[t._v("PHP 7.4 (7.3 min) with: "),a("code",[t._v("curl hash json mbstring pdo pdo-mysql zip session")])]),t._v(" "),a("li",[t._v("Database: MySQL 8 / MariaDB 10")]),t._v(" "),a("li",[t._v("Cron")]),t._v(" "),a("li",[t._v("Web Server: Nginx / Apache / *"),a("em",[t._v("any")])])]),t._v(" "),a("h2",{attrs:{id:"php"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#php"}},[t._v("#")]),t._v(" PHP")]),t._v(" "),a("p",[t._v("The following "),a("code",[t._v("ini")]),t._v(" directives are recommended for Chevereto installations:")]),t._v(" "),a("div",{staticClass:"language-ini extra-class"},[a("pre",{pre:!0,attrs:{class:"language-ini"}},[a("code",[a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("upload_max_filesize")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" 20M;")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("post_max_size")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" 20M;")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("max_execution_time")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" 30;")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("memory_limit")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" 512M;")]),t._v("\n")])])]),a("h2",{attrs:{id:"database"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#database"}},[t._v("#")]),t._v(" Database")]),t._v(" "),a("p",[t._v("MySQL/MariaDB user must have "),a("code",[t._v("ALL PRIVILEGES")]),t._v(" over the target database. Chevereto will require the following for connecting to the database:")]),t._v(" "),a("ul",[a("li",[t._v("Database name")]),t._v(" "),a("li",[t._v("Database user and its password")])]),t._v(" "),a("h2",{attrs:{id:"cron"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#cron"}},[t._v("#")]),t._v(" Cron")]),t._v(" "),a("p",[t._v("A cron is required to process the application background jobs. The cron for your installation may look like this:")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[t._v("* * * * * "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("IS_CRON")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" /usr/bin/php /var/www/html/chevereto.loc/public_html/cron.php "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("/dev/null "),a("span",{pre:!0,attrs:{class:"token operator"}},[a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("2")]),t._v(">")]),a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("&1")]),t._v("\n")])])]),a("p",[t._v("Where "),a("a",{attrs:{href:"https://crontab.guru/#*_*_*_*_*",target:"_blank",rel:"noopener noreferrer"}},[t._v("* * * * *"),a("OutboundLink")],1),t._v(" is the cron schedule.")]),t._v(" "),a("h3",{attrs:{id:"testing-cron"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#testing-cron"}},[t._v("#")]),t._v(" Testing cron")]),t._v(" "),a("p",[t._v("You can go to "),a("a",{attrs:{href:"https://explainshell.com/explain?cmd=IS_CRON%3D1+%2Fusr%2Fbin%2Fphp+%2Fvar%2Fwww%2Fhtml%2Fchevereto.loc%2Fpublic_html%2Fcron.php+%3E%2Fdev%2Fnull+2%3E%261",target:"_blank",rel:"noopener noreferrer"}},[t._v("explainshell"),a("OutboundLink")],1),t._v(" to inspect the command, you can freely alter it to match your needs. Run the command as "),a("code",[t._v("www-data")]),t._v(" user by adding "),a("code",[t._v("sudo -u www-data")]),t._v(" to the command:")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" -u www-data "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("IS_CRON")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" /usr/bin/php /var/www/html/chevereto.loc/public_html/cron.php "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("/dev/null "),a("span",{pre:!0,attrs:{class:"token operator"}},[a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("2")]),t._v(">")]),a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("&1")]),t._v("\n")])])]),a("h2",{attrs:{id:"web-server"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#web-server"}},[t._v("#")]),t._v(" Web server")]),t._v(" "),a("h3",{attrs:{id:"php-provisioning"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#php-provisioning"}},[t._v("#")]),t._v(" PHP provisioning")]),t._v(" "),a("p",[t._v("The web server must be configured to execute "),a("a",{attrs:{href:"http://php.net/",target:"_blank",rel:"noopener noreferrer"}},[t._v("PHP"),a("OutboundLink")],1),t._v(" and it is "),a("strong",[t._v("recommended")]),t._v(" to provision it using "),a("a",{attrs:{href:"https://www.php.net/manual/en/install.fpm.php",target:"_blank",rel:"noopener noreferrer"}},[t._v("PHP-FPM"),a("OutboundLink")],1),t._v(".")]),t._v(" "),a("h3",{attrs:{id:"filesystem"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#filesystem"}},[t._v("#")]),t._v(" Filesystem")]),t._v(" "),a("p",[t._v("The webserver user should be in the owner group of your installation. This is required to allow Chevereto to modify the filesystem, which is required to one-click update and many other features.")]),t._v(" "),a("blockquote",[a("p",[t._v("Web server user is usually "),a("code",[t._v("www-data")])])]),t._v(" "),a("p",[t._v("Chevereto requires "),a("strong",[t._v("recursive write")]),t._v(" access in the following paths:")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("app/content")])]),t._v(" "),a("li",[a("code",[t._v("app/content/languages")])]),t._v(" "),a("li",[a("code",[t._v("app/content/languages/cache")])]),t._v(" "),a("li",[a("code",[t._v("app/content/system")])]),t._v(" "),a("li",[a("code",[t._v("content")])]),t._v(" "),a("li",[a("code",[t._v("images")])])]),t._v(" "),a("p",[a("code",[t._v("Read")]),t._v(" and "),a("code",[t._v("Write")]),t._v(" access to the temp folder ("),a("code",[t._v("/tmp")]),t._v(" in Linux; "),a("code",[t._v("C:/Windows/Temp")]),t._v(" in Windows).")]),t._v(" "),a("h3",{attrs:{id:"url-rewriting"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#url-rewriting"}},[t._v("#")]),t._v(" URL rewriting")]),t._v(" "),a("p",[t._v("The web server must rewrite HTTP requests like "),a("code",[t._v("GET /image/some-name.<id>")]),t._v(" to "),a("code",[t._v("/index.php")]),t._v(". Instructions for "),a("a",{attrs:{href:"https://nginx.org/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Nginx"),a("OutboundLink")],1),t._v(" and "),a("a",{attrs:{href:"https://httpd.apache.org/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Apache HTTP Server"),a("OutboundLink")],1),t._v(" below.")]),t._v(" "),a("h4",{attrs:{id:"nginx-url-rewriting"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#nginx-url-rewriting"}},[t._v("#")]),t._v(" Nginx URL rewriting")]),t._v(" "),a("p",[a("code",[t._v("example.com.conf")])]),t._v(" "),a("div",{staticClass:"language-nginx extra-class"},[a("pre",{pre:!0,attrs:{class:"language-nginx"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Context limits")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("client_max_body_size")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),t._v("M"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Disable access to sensitive files")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("location")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("~")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("app"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("content"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("lib"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("\\"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("po"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("php"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("lock"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("sql"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("$ "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("deny")]),t._v(" all"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Image not found replacement")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("location")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("~")]),t._v(" \\"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("jpe"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),t._v("g"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("png"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("gif"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("webp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("$ "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("log_not_found")]),t._v(" off"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("error_page")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("404")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("content"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("images"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("system"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("default"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("404.")]),t._v("gif"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# CORS header (avoids font rendering issues)")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("location")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("~")]),t._v(" \\"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ttf"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("ttc"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("otf"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("eot"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("woff"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("woff2"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("font"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("css"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("css"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("js"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("$ "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("add_header")]),t._v(" Access"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Control"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Allow")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Origin "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"*"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Pretty URLs")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("location")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("index")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("index")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("php"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("try_files")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$uri")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$uri")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("index")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("php"),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$is_args")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$query_string")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h4",{attrs:{id:"apache-http-server-url-rewriting"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#apache-http-server-url-rewriting"}},[t._v("#")]),t._v(" Apache HTTP Server URL rewriting")]),t._v(" "),a("p",[t._v("Make sure that "),a("a",{attrs:{href:"https://httpd.apache.org/docs/current/mod/mod_rewrite.html",target:"_blank",rel:"noopener noreferrer"}},[a("code",[t._v("mod_rewrite")]),a("OutboundLink")],1),t._v(" is enabled and that your virtual host settings allows to perform URL rewriting:")]),t._v(" "),a("div",{staticClass:"language-apache extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("    <Directory /var/www/html>\n        Options -Indexes +FollowSymLinks +MultiViews\n        AllowOverride All\n        Require all granted\n    </Directory>\n")])])]),a("p",[t._v("Apache configuration "),a("code",[t._v(".htaccess")]),t._v(" files are already included in the software.")]),t._v(" "),a("p",[a("code",[t._v("/.htaccess")])]),t._v(" "),a("div",{staticClass:"language-apache extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('# Disable server signature\nServerSignature Off\n\n# Enable CORS across all your subdomains (replace dev\\.local with your domain\\.com)\n# SetEnvIf Origin ^(https?://.+\\.dev\\.local(?::\\d{1,5})?)$   CORS_ALLOW_ORIGIN=$1\n# Header append Access-Control-Allow-Origin  %{CORS_ALLOW_ORIGIN}e   env=CORS_ALLOW_ORIGIN\n# Header merge  Vary "Origin"\n\n# Disable directory listing (-indexes), Multiviews (-MultiViews)\nOptions -Indexes\nOptions -MultiViews\n\n<IfModule mod_rewrite.c>\n\n    RewriteEngine On\n\n    # If you have problems with the rewrite rules remove the "#" from the following RewriteBase line\n    # You will also have to change the path to reflect the path to your Chevereto installation\n    # If you are using alias is most likely that you will need this.\n    #RewriteBase /\n\n    # 404 images\n    # If you want to have your own fancy "image not found" image remove the "#" from RewriteCond and RewriteRule lines\n    # Make sure to apply the correct paths to reflect your current installation\n    RewriteCond %{REQUEST_FILENAME} !-f\n    RewriteRule images/.+\\.(gif|jpe?g|png|bmp|webp) - [NC,L,R=404]\n    #RewriteRule images/.+\\.(gif|jpe?g|a?png|bmp|webp) content/images/system/default/404.gif [NC,L]\n\n    RewriteCond %{REQUEST_FILENAME} !-f\n    RewriteCond %{REQUEST_FILENAME} !-d\n    RewriteCond %{REQUEST_URI} !\\.(css|js|html|htm|rtf|rtx|svg|svgz|txt|xsd|xsl|xml|asf|asx|wax|wmv|wmx|avi|bmp|class|divx|doc|docx|exe|gif|gz|gzip|ico|jpe?g|jpe|mdb|mid|midi|mov|qt|mp3|m4a|mp4|m4v|mpeg|mpg|mpe|mpp|odb|odc|odf|odg|odp|ods|odt|ogg|pdf|png|pot|pps|ppt|pptx|ra|ram|swf|tar|tif|tiff|wav|webp|wma|wri|xla|xls|xlsx|xlt|xlw|zip)$ [NC]\n    RewriteRule . index.php [L]\n\n</IfModule>\n')])])]),a("h3",{attrs:{id:"real-connecting-ip"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#real-connecting-ip"}},[t._v("#")]),t._v(" Real connecting IP")]),t._v(" "),a("p",[t._v("For setups under any kind of proxy (including CloudFlare) is required that the web server sets the appropriate value for the client connecting IP.")]),t._v(" "),a("blockquote",[a("p",[t._v("⚠ If this is not configured the software won't be able to detect the users IPs")])]),t._v(" "),a("ul",[a("li",[t._v("Nginx: "),a("code",[t._v("ngx_http_realip_module")])]),t._v(" "),a("li",[t._v("Apache: "),a("code",[t._v("mod_remoteip")])])])])}),[],!1,null,null,null);e.default=r.exports}}]);